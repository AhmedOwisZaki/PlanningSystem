<div class="editor-panel">
    <div style="background: red; color: white; padding: 10px; font-weight: bold; text-align: center;">
        EDITOR IS WORKING CHECK
    </div>
    <!-- Tab Navigation -->
    <div class="editor-tabs">
        <div class="tab" [class.active]="activeTab === 'project'" (click)="toggleTab('project')">Project</div>
        <div class="tab" [class.active]="activeTab === 'resources'" (click)="toggleTab('resources')">Resources</div>
        <div class="tab" [class.active]="activeTab === 'calendars'" (click)="toggleTab('calendars')">Calendars</div>
    </div>

    <!-- Tab Content -->
    <div class="editor-content" (click)="deselectResource()">

        <!-- PROJECT TAB -->
        <div *ngIf="activeTab === 'project'" class="tab-pane project-pane">
            <h3>Project Settings</h3>

            <div class="project-info">
                <div class="info-row">
                    <label>Project Name:</label>
                    <span>{{ projectName() }}</span>
                </div>
                <div class="info-row">
                    <label>Start Date:</label>
                    <span>{{ projectStartDate() | date:'MMM d, y' }}</span>
                </div>
                <div class="info-row">
                    <label>End Date:</label>
                    <span>{{ projectEndDate() | date:'MMM d, y' }}</span>
                </div>
                <div class="info-row">
                    <label>Total Activities:</label>
                    <span>{{ activities().length }}</span>
                </div>
            </div>

            <div class="export-section">
                <h4>Export</h4>
                <button class="btn-export" (click)="exportToXER()">
                    ðŸ“¥ Export to Primavera P6 (.xer)
                </button>
            </div>

            <div class="evm-section">
                <h4>EVM Analysis</h4>
                <button class="btn-s-curves" (click)="openSCurves()">
                    ðŸ“Š View S-Curves Chart
                </button>
            </div>
        </div>

        <!-- RESOURCES TAB -->
        <div *ngIf="activeTab === 'resources'" class="tab-pane resources-pane">

            <!-- Header with Actions -->
            <div class="resources-header" (click)="$event.stopPropagation()">
                <div class="header-left">
                    <h3>All Resources</h3>
                    <button class="btn-profile" [disabled]="!selectedResource()" [class.active]="selectedResource()"
                        (click)="openProfile($event)">
                        Show resource usage profile
                    </button>
                </div>
                <button class="btn-add" (click)="startAddResource()" *ngIf="!showAddResourceForm">+</button>
            </div>

            <!-- Add Resource Form -->
            <div class="add-resource-form" *ngIf="showAddResourceForm" (click)="$event.stopPropagation()">
                <h4>New Resource</h4>
                <div class="form-row">
                    <input type="text" [(ngModel)]="newResource.name" placeholder="Resource Name" class="form-control"
                        autofocus>
                </div>
                <div class="form-row">
                    <select [(ngModel)]="newResource.resourceTypeId" class="form-control">
                        <option *ngFor="let type of resourceTypes()" [value]="type.id">{{ type.name }}</option>
                    </select>
                </div>
                <div class="form-row" style="display: flex; gap: 10px;">
                    <input type="number" [(ngModel)]="newResource.costPerUnit" placeholder="Cost" class="form-control"
                        style="width: 80px;">
                    <input type="text" [(ngModel)]="newResource.unit" placeholder="Unit (e.g. hour)"
                        class="form-control">
                </div>
                <div class="form-actions">
                    <button (click)="cancelAddResource()" class="btn-cancel">Cancel</button>
                    <button (click)="saveNewResource()" class="btn-save">Save</button>
                </div>
            </div>

            <!-- Resource List (No Side Panel) -->
            <div class="resource-categories">
                <div class="category-group" *ngFor="let group of resourcesByType()">

                    <!-- Category Header -->
                    <div class="category-header" [class.human]="group.name === 'Human'"
                        [class.machine]="group.name === 'Machine'" [class.material]="group.name === 'Material'"
                        (click)="toggleCategory(group.id); $event.stopPropagation()">
                        <span class="care-icon">{{ isCategoryExpanded(group.id) ? 'â–¼' : 'â–¶' }}</span>
                        <span class="category-name">{{ group.name }}</span>
                        <span class="count-badge">{{ group.resources.length }}</span>
                    </div>

                    <!-- Resource List -->
                    <div class="resource-list" *ngIf="isCategoryExpanded(group.id)">
                        <div class="resource-item" *ngFor="let res of group.resources"
                            [class.selected]="selectedResource() === res" (click)="selectResource(res, $event)">
                            <div class="res-name">{{ res.name }}</div>
                            <div class="res-cost">{{ res.costPerUnit | currency }} / {{ res.unit }}</div>
                        </div>
                        <div class="no-resources" *ngIf="group.resources.length === 0">
                            No resources
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- CALENDARS TAB -->
        <div *ngIf="activeTab === 'calendars'" class="tab-pane calendars-pane">
            <h3>Work Calendars</h3>

            <div class="calendar-list">
                <div class="calendar-card" *ngFor="let calendar of calendars()">
                    <div class="calendar-header">
                        <h4>{{ calendar.name }}</h4>
                        <span class="default-badge" *ngIf="calendar.isDefault">Default</span>
                    </div>

                    <div class="calendar-info">
                        <div class="info-row">
                            <span class="label">Work Hours/Day:</span>
                            <span>{{ calendar.workHoursPerDay }} hours</span>
                        </div>

                        <div class="info-row">
                            <span class="label">Work Days:</span>
                            <span>{{ getWorkDaysText(calendar.workDays) }}</span>
                        </div>

                        <div class="info-row">
                            <span class="label">Holidays:</span>
                            <span>{{ calendar.holidays.length }} defined</span>
                        </div>
                    </div>
                </div>

                <div class="no-calendars" *ngIf="calendars().length === 0">
                    <p>No calendars defined. A default calendar will be created automatically.</p>
                </div>
            </div>
        </div>

    </div>

    <!-- Resource Profile Modal (Reusing structure for consistency) -->


    <!-- S-Curves Modal -->
    <div class="s-curves-modal" *ngIf="showSCurves()" (click)="closeSCurves()">
        <div class="s-curves-content" (click)="$event.stopPropagation()">
            <button class="close-modal-btn" (click)="closeSCurves()">Ã—</button>
            <app-s-curves-chart></app-s-curves-chart>
        </div>
    </div>
</div>